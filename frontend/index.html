<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/svg+xml" href="/vite.svg">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="./src/loging/CSS/style.css" id="login-style">
</head>
<body>
    <div id="login-container">
        <form id="login-form">
            <img src="./src/loging/img/login.png" alt="user-img">
            <label for="username">Usuario</label>
            <input type="text" id="username" placeholder="@usuario" required>
            <label for="password">Contraseña</label>
            <input type="password" id="password" placeholder="Contraseña" required>
            <div class="checkboxes">
                <div class="box-visible">
                    <input type="checkbox" id="visible">
                    <label for="visible">Mostrar Contraseña</label>
                </div>
                <div class="box-remember">
                    <input type="checkbox" id="remember">
                    <label for="remember">Recordar Contraseña</label>
                </div>
            </div>
            <button type="submit" id="submit">Iniciar Sesión</button>
        </form>
    </div>

    <div id="root" style="display: none;"></div>

    <script type="module">
        const $loginForm = document.getElementById("login-form");
        const $root = document.getElementById("root");
        const $loginStyle = document.getElementById("login-style");

        $loginForm.addEventListener("submit", (e) => {
            e.preventDefault();
            const usernameValue = document.getElementById("username").value.trim();
            const passwordValue = document.getElementById("password").value.trim();

            // Aquí deberías hacer una petición al servidor para autenticar las credenciales del usuario.
            // Simularemos un inicio de sesión exitoso si las credenciales son correctas.

            if (usernameValue === "admin" && passwordValue === "admin2024.") {
                // Guardar las credenciales en localStorage si se ha marcado la opción de recordar
                if (document.getElementById("remember").checked) {
                    localStorage.setItem("username", usernameValue);
                    localStorage.setItem("password", passwordValue);
                }
                // Ocultar el formulario de inicio de sesión y mostrar el contenido principal
                $root.style.display = "block";
                document.getElementById("login-container").style.display = "none";
                // Bloquear el CSS después de iniciar sesión
                $loginStyle.disabled = true;
            } else {
                alert("Usuario o contraseña incorrectos");
            }
        });

        // Función para cargar las credenciales guardadas al cargar la página
        window.onload = function() {
            const savedUsername = localStorage.getItem("username");
            const savedPassword = localStorage.getItem("password");

            if (savedUsername && savedPassword) {
                document.getElementById("username").value = savedUsername;
                document.getElementById("password").value = savedPassword;
            }
        };

        // Mostrar u ocultar la contraseña según el estado del checkbox
        document.addEventListener("change", (e) => {
            if (e.target.id === "visible") {
                const $password = document.getElementById("password");
                $password.type = e.target.checked ? "text" : "password";
            }
        });
    </script>
    <script type="module" src="/src/main.jsx"></script>
</body>
</html>